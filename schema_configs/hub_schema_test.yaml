version: 2

collision_code: test
target_entity_type: hub
target_schema: auto_dv_integration

models:
  - target: hub_customer
    source: auto_dv_psa.customer
    partition: 
      - days(dv_src_ldt)
    columns:
      - target: dv_hkey_hub_customer
        data_type: string
        key_type: hash_key_hub
        source:
          - cst_no
        tests:
          - unique
          - not_null

      - target: cst_no
        data_type: string
        key_type: biz_key
        source: 
          - cst_no

  - target: hub_branch
    source: auto_dv_psa.customer
    partition:
      - days(dv_src_ldt)
    columns:
      - target: dv_hkey_hub_branch
        data_type: string
        key_type: hash_key_hub
        source:
          - br_cd
        tests:
          - unique
          - not_null

      - target: br_cd
        data_type: string
        key_type: biz_key
        source: 
          - br_cd